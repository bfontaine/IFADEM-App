<!doctype html>
<html lang="{{ lang|default('fr') }}" dir="{{ dir|default('ltr') }}">
    <head>
        <meta charset="utf-8" />
        <meta name="language" content="{{ lang|default('fr') }}" />

        <title>{{ main_title|default('IFADEM') }}</title>

        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="js/jquery.mobile-1.3.1.min.css" />
        <link rel="stylesheet" href="css/main.css" />
        <script src="js/jquery-1.9.1.min.js"></script>
        <script src="js/jquery.mobile-1.3.1.min.js"></script>

        {# Icons #}
        <link rel="icon" type="image/png"        href="imgs/ifadem-logo.png" />
        <link rel="apple-touch-icon"             href="imgs/ifadem-logo.png" />
        <link rel="apple-touch-icon-precomposed" href="imgs/ifadem-logo.png" />
    </head>
    <body>
        {#
        <script type="data/json" id="json-countries">{{ countries|json_encode()|raw }}</script>
        #}

        <div data-role="page" id="home">
            <div data-role="header">
                {#
                <a href="#help" data-role="button" data-icon="info" data-iconpos="notext">{{ help.button|default('Aide') }}</a>
                #}

                <a href="#cancelling-confirmation" data-role="button" data-rel="popup"
                                                   data-icon="delete" data-iconpos="notext"
                                                   id="b_cancel" class="nodisplay">{{ buttons.cancel|default('Annuler') }}</a>

                <h1>{{ title|default('IFADEM') }}</h1>

                <a href="#" data-role="button"
                            data-icon="check"
                            data-iconpos="notext"
                            id="select-contents">{{ buttons.check|default('OK') }}</a>

            </div>
            <div data-role="content">

                <div data-role="fieldcontain">
                    <label for="pseudo_inp">Pseudo&nbsp;:</label>
                    <input type="text" name="pseudo" id="pseudo_inp" value="" data-mini="true" />
                </div>

                <div data-role="collapsible-set" data-inset="false">
                    {% for country in countries %}
                    <div data-role="collapsible">
                        <h2>{{ country.name }}<span class="selected-count"><span class="count">{{ country.selected_count }}</span>/{{ country.contents|length|default('0') }}</span></h2>
                        <ul data-role="listview" data-filter="true"
                                                 data-filter-placeholder="{{ filter.placeholder|default('Filtrer les ressources…') }}">
                            {% for content in country.contents %}
                            <li data-content-id="{{ content.id }}" class="content{% if content.selected %} selected{% endif %}">
                                <img src="{{ content.thumbnail }}" class="content-thumbnail" />
                                <h3>{{ content.title }}</h3>
                                <p>{{ content.description }}</p>
                                <p class="ui-li-aside">{{ content.size }}</p>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endfor %}
                </div>
            </div>

            {% for country in countries %}
                {% for content in country.contents %}
            <div data-role="popup" id="content-details-{{ content.id }}">
                <h3>{{ content.title }}</h3>
                <p>{{ content.description }}</p>
                <ul class="content-infos">
                    <li>Difficulté&nbsp;: {{ content.difficulty|default('non précisée') }}</li>
                    <li>Langue&nbsp;: {{ content.lang|default('non précisée') }}</li>
                    <li>Date de création&nbsp;: {{ content.creation_date|date('d/m/Y à H:i') }}</li>
                    {% if content.modification_date %}
                    <li>Date de dernière modification&nbsp;: {{ content.modification_date|date('d/m/Y à H:i') }}</li>
                    {% endif %}
                    <li>Nombre de fichiers MP3&nbsp;: {{ content.mp3s_count }}</li>
                </ul>
            </div>
                {% endfor %}
            {% endfor %}

            <div data-role="popup" id="cancelling-confirmation">
                <p>Êtes-vous sûr de vouloir annuler toute la sélection&nbsp;?
                   Cette action est irréversible, et désélectionnera
                   toutes les ressources actuellement sélectionnées.</p>
                <a href="#home" data-role="button" data-rel="back">Non</a>
                <a href="#home" data-role="button" data-rel="back" id="confirm-cancelling">Oui</a>
            </div>
        </div>

        {#
        <div data-role="page" id="help">
            <div data-role="header">
                <a href="#" data-role="button" data-rel="back" data-icon="back" data-iconpos="notext">{{ back_button|default('Retour') }}</a>
                <h1>{{ help.title|default('Aide') }}</h1>
            </div>
            <div data-role="content">{{ help.text|default('') }}</div>
        </div>
        #}

        <script src="js/app.js"></script>
    </body>
</html>
